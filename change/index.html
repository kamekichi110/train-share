<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>乗り換え案内</title>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="shortcut icon" href="../asset/icon/favicon.ico" type="image/x-icon">
    <script src="../js/main.js"></script>
    <script   src="https://code.jquery.com/jquery-3.7.1.js"   integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="   crossorigin="anonymous"></script>
    <script>
        function searchTRAIN() {
    var result = document.getElementById("result");
    var ver = document.getElementById("version");
    result.src = "wait.html";
    var location1 = document.getElementById("location1").value;
    var location2 = document.getElementById("location2").value;
    var set1 = "https://api.ekispert.jp/v1/json/search/course/light?from=";
    var set2 = "&to";
    var set3 = "&searchType=departure&shinkansen=";
    var set3_list = document.getElementById("set3").value;
    var set4 = "&limitedExpress=";
    var set4_list = document.getElementById("set4").value;
    var set5 = "&redirect=true&contentsMode=sp&key="
    var fromData = document.getElementById("from").value;
    var forData = document.getElementById("for").value;
    var fromText = fromData + location1;
    var forText = forData + location2;
    var url = set1 + fromText + set2 + forText + set3 + set3_list + set4 + set4_list +set5;
    var encodeData = encodeURI(url);
    const encode = encodeData + "LE_DDLV9n4GxgPku";
    $(function () {
        $.ajax({
          url: encode,
          type: "GET",
          dataType: "text",
        })
          .done(function (data) {
            // success
            //取得jsonデータ
            var data_stringify = JSON.stringify(data);
            var data_json = JSON.parse(data_stringify);
            //jsonデータから各データを取得
            var data = data_json.ResultSet.ResourceURI;
            //出力
            $("#result").src = data;
          })
          .fail(function (data) {
            // error
            console.log("error");
          });
      });
    }
      </script>
</head>
<body>
    <header>
        <img src="https://kamekichi110.github.io/train-share/asset/icon/main.png" class="icon">
        <h2>
          Train-Share
          <br>
          鉄道情報掲載サイト
        </h2>
      </header>
      <article>
        <br>
        <section>
          <h3></h3>
          <p></p>
        </section>
        <br>
        <main>
            <p><input type="text" id="from" placeholder="出発駅">駅</p>
            <p>地域を選択<select name="set3" id="set3"></select></p>
            <p><input type="text" id="for" placeholder="到着駅">駅</p>
            <p>地域を選択<select name="set4" id="set4"></select></p>
            <br>
            <button type="button" onclick="searchTRAIN()">検索</button>
            <hr>
            <br>
            <iframe src="./wait.html" frameborder="0" id="result"></iframe>
        </main>
        <br>
        <div class="footer">
          <p><p id="day"></p>
            <br>管理者X(旧Twitter)<a href="https://twitter.com/sirokuma_8110F">link</a>
            <br>各種ツール
            <br><a href="https://kamekichi110.github.io/train-share/view/train-info.html">列車情報ビューアー</a>
            <a href="https://kamekichi110.github.io/train-share/photo/index.html">思い出写真</a>
          <a href="https://kamekichi110.github.io/train-share/index.html">home</a>
          </p>
        </div>
      </article>
</body>
</html>