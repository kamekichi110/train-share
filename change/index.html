<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>乗り換え案内</title>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="shortcut icon" href="../asset/icon/favicon.ico" type="image/x-icon">
    <script src="../js/main.js"></script>
</head>
<body>
    <header>
        <img src="https://kamekichi110.github.io/train-share/asset/icon/main.png" class="icon">
        <h2>
          Train-Share
          <br>
          鉄道情報掲載サイト
        </h2>
      </header>
      <article>
        <br>
        <section>
          <h3>乗り換え案内</h3>
          <p>ただいま準備中です。</p>
          <p>駅名で同じ名前がある時は<br>県を指定してください</p>
          <p>それ以外の場合は「指定なし」<br>を選択してください。</p>
        </section>
        <br>
        <main>
          <p><input type="text" id="from" placeholder="出発駅を入力">駅</p>
          <select name="listFrom" id="location1">
            <option value="">指定なし</option>
            <optgroup label="北海道地方">
            <option value="(北海道)">北海道</option>
            </optgroup>
            <optgroup label="東北地方">
            <option value="(青森県)">青森県</option>
            <option value="(岩手県)">岩手県</option>
            <option value="(宮城県)">宮城県</option>
            <option value="(秋田県)">秋田県</option>
            <option value="(山形県)">山形県</option>
            <option value="(福島県)">福島県</option>
            </optgroup>
            <optgroup label="関東地方">
            <option value="(茨城県)">茨城県</option>
            <option value="(栃木県)">栃木県</option>
            <option value="(群馬県)">群馬県</option>
            <option value="(埼玉県)">埼玉県</option>
            <option value="(千葉県)">千葉県</option>
            <option value="(東京都)">東京都</option>
            <option value="(神奈川県)">神奈川県</option>
            </optgroup>
            <optgroup label="中部地方">
              <option value="(新潟県)">新潟県</option>
              <option value="(富山県)">富山県</option>
              <option value="(石川県)">石川県</option>
              <option value="(福井県)">福島県</option>
              <option value="(山梨県)">山梨県</option>
              <option value="(長野県)">長野県</option>
              <option value="(岐阜県)">岐阜県</option>
              <option value="(静岡県)">静岡県</option>
              <option value="(愛知県)">愛知県</option>
            </optgroup>
            <optgroup label="近畿地方">
              <option value="(三重県)">三重県</option>
              <option value="(滋賀県)">滋賀県</option>
              <option value="(京都府)">京都府</option>
              <option value="(大阪府)">大阪府</option>
              <option value="(兵庫県)">兵庫県</option>
              <option value="(奈良県)">奈良県</option>
              <option value="(和歌山県)">和歌山県</option>
            </optgroup>
            <optgroup label="中国・四国地方">
              <option value="(鳥取県)">鳥取県</option>
              <option value="(島根県)">島根県</option>
              <option value="(岡山県)">岡山県</option>
              <option value="(広島県)">広島県</option>
              <option value="(山口県)">山口県</option>
              <option value="(徳島県)">徳島県</option>
              <option value="(香川県)">香川県</option>
              <option value="(愛媛県)">愛媛県</option>
              <option value="(高知県)">高知県</option>
            </optgroup>
            <optgroup label="九州・沖縄地方">
              <option value="(福岡県)">福岡県</option>
              <option value="(佐賀県)">佐賀県</option>
              <option value="(長崎県)">長崎県</option>
              <option value="(熊本県)">熊本県</option>
              <option value="(大分県)">大分県</option>
              <option value="(宮崎県)">宮崎県</option>
              <option value="(鹿児島県)">鹿児島県</option>
              <option value="(沖縄県)">沖縄県</option>
            </optgroup>
          </select>
          <br>
          <p><input type="text" id="for" placeholder="到着駅を入力">駅</p>
          <select name="listFor" id="location2">
              <option value="">指定なし</option>
              <optgroup label="北海道地方">
                  <option value="(北海道)">北海道</option>
              </optgroup>
              <optgroup label="東北地方">
                  <option value="(青森県)">青森県</option>
                  <option value="(岩手県)">岩手県</option>
                  <option value="(宮城県)">宮城県</option>
                  <option value="(秋田県)">秋田県</option>
                  <option value="(山形県)">山形県</option>
                  <option value="(福島県)">福島県</option>
              </optgroup>
              <optgroup label="関東地方">
                  <option value="(茨城県)">茨城県</option>
                  <option value="(栃木県)">栃木県</option>
                  <option value="(群馬県)">群馬県</option>
                  <option value="(埼玉県)">埼玉県</option>
                  <option value="(千葉県)">千葉県</option>
                  <option value="(東京都)">東京都</option>
                  <option value="(神奈川県)">神奈川県</option>
              </optgroup>
              <optgroup label="中部地方">
                  <option value="(新潟県)">新潟県</option>
                  <option value="(富山県)">富山県</option>
                  <option value="(石川県)">石川県</option>
                  <option value="(福井県)">福島県</option>
                  <option value="(山梨県)">山梨県</option>
                  <option value="(長野県)">長野県</option>
                  <option value="(岐阜県)">岐阜県</option>
                  <option value="(静岡県)">静岡県</option>
                  <option value="(愛知県)">愛知県</option>
              </optgroup>
              <optgroup label="近畿地方">
                  <option value="(三重県)">三重県</option>
                  <option value="(滋賀県)">滋賀県</option>
                  <option value="(京都府)">京都府</option>
                  <option value="(大阪府)">大阪府</option>
                  <option value="(兵庫県)">兵庫県</option>
                  <option value="(奈良県)">奈良県</option>
                  <option value="(和歌山県)">和歌山県</option>
              </optgroup>
              <optgroup label="中国・四国地方">
                  <option value="(鳥取県)">鳥取県</option>
                  <option value="(島根県)">島根県</option>
                  <option value="(岡山県)">岡山県</option>
                  <option value="(広島県)">広島県</option>
                  <option value="(山口県)">山口県</option>
                  <option value="(徳島県)">徳島県</option>
                  <option value="(香川県)">香川県</option>
                  <option value="(愛媛県)">愛媛県</option>
                  <option value="(高知県)">高知県</option>
              </optgroup>
              <optgroup label="九州・沖縄地方">
                  <option value="(福岡県)">福岡県</option>
                  <option value="(佐賀県)">佐賀県</option>
                  <option value="(長崎県)">長崎県</option>
                  <option value="(熊本県)">熊本県</option>
                  <option value="(大分県)">大分県</option>
                  <option value="(宮崎県)">宮崎県</option>
                  <option value="(鹿児島県)">鹿児島県</option>
                  <option value="(沖縄県)">沖縄県</option>
              </optgroup>
          </select>
          <br>
          <hr>
          <br>
          <p>新幹線<select name="set3" id="set3">
            <option value="true">オン</option>
            <option value="false">オフ</option>
          </select></p>
          <p>特急<select name="set4" id="set4">
            <option value="true">オン</option>
            <option value="false">オフ</option>
          </select></p>
          <br>
          <hr>
          <br>
          <button onclick="searchTRAIN()">検索！</button>
          <br>
          <hr>
          <br>
          <iframe src="./wait.html" frameborder="0" id="result"></iframe>
          <p id="version">API-version:取得中…</p>
          <br>
          <br>
          <div id="url"></div>
        </main>
        <br>
        <div class="footer">
          <p><p id="day"></p>
            <br>管理者X(旧Twitter)<a href="https://twitter.com/sirokuma_8110F">link</a>
            <br>各種ツール
            <br><a href="https://kamekichi110.github.io/train-share/view/train-info.html">列車情報ビューアー</a>
            <a href="https://kamekichi110.github.io/train-share/photo/index.html">思い出写真</a>
          <a href="https://kamekichi110.github.io/train-share/index.html">home</a>
          </p>
        </div>
      </article>
      <script>
        function searchTRAIN() {
    var result = document.getElementById("result");
    var ver = document.getElementById("version");
    result.src = "wait.html";
    var location1 = document.getElementById("location1").value;
    var location2 = document.getElementById("location2").value;
    var set1 = "https://api.ekispert.jp/v1/json/search/course/light?from=";
    var set2 = "&to";
    var set3 = "&searchType=departure&shinkansen=";
    var set3_list = document.getElementById("set3").value;
    var set4 = "&limitedExpress=";
    var set4_list = document.getElementById("set4").value;
    var set5 = "&redirect=true&contentsMode=sp&key=LE_DDLV9n4GxgPku"
    var fromData = document.getElementById("from").value;
    var forData = document.getElementById("for").value;
    var fromText = fromData + location1;
    var forText = forData + location2;
    var url = set1 + fromText + set2 + forText + set3 + set3_list + set4 + set4_list +set5;
    var encode = encodeURI(url);
    //リクエストオブジェクト生成
    const xhr = new XMLHttpRequest;

    //リクエスト
    xhr.open('GET', encode);

    //リクエスト送信
    xhr.send();

    //自動的に実行される関数
            const jsonData = JSON.parse(xhr.responseText);

            for (let item of jsonData) {
                var requestURL = item.ResultSet.ResourceURI;
                result.src = requestURL;
                ver.innerHTML = "API-version:" + item.ResultSet.apiVersion;
                console.log = requestURL;
            }
    }
</script>
</body>
</html>